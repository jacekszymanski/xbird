#summary HTML web page scraping
#labels Phase-Implementation,Featured

== Introduction ==

XQuery can be used effectively as a HTML/XML [http://en.wikipedia.org/wiki/Web_scraping web-scraping] engine (see #1 for detail).

== Example ==

We provide here an example that extracts the following text messeges in this HTML page by XQuery.

{{{ 
Extract me please!
}}}
{{{
Me too ;-(
}}}

[http://xbird.googlecode.com/svn/trunk/xbird-open/examples/scraping/googlecode1.xq The following query] extracts [http://xbird.googlecode.com/svn/trunk/site/resources/misc/googlecode1.xq.html the table] as provided below.

{{{
 <table border="1">
  <tr bgcolor="lightgreen">
    <td>order</td><td>message</td>
  </tr>
 {
	let $page := fn:doc("http://code.google.com/p/xbird/wiki/WebScraping")
	for $code at $pos in $page/html/body/div[@id='maincol']/div[@id='wikicontent']/pre
        where $pos le 2
	return 
		<tr>
		  <td>{ $pos }</td>
		  <td>{ fn:data($code) }</td>
		</tr>
 }
 </table>
}}}
|| order || message ||
|| 1 || Extract me please! ||
|| 2 || Me too ;-( ||

== Current limitation ==

XBird uses [http://sourceforge.net/projects/nekohtml NekoHTML] or [http://ccil.org/~cowan/XML/tagsoup/ TagSoup] for the HTML parser in [http://xbird.googlecode.com/svn/trunk/xbird-open/main/src/java/xbird/xquery/dm/instance/DocumentTableModel.java DocumentTableModel class]. These parsers does not handle javascripts.

The HTML parser is configurable through _xbird.util.xml.HTMLSAXParser_ property in [http://xbird.googlecode.com/svn/trunk/xbird-open/main/conf/xbird/config/xbird.properties xbird.properties]. 

Javascript-aware HTML parsers such as [http://lobobrowser.org/cobra/java-html-parser.jsp Cobra: Java HTML Parser] could be a help. 

== List of future information == 
  * [http://www.ibm.com/developerworks/xml/library/j-jtp03225.html Java theory and practice: Screen-scraping with XQuery]^#1^
  * [http://en.wikipedia.org/wiki/Web_scraping Web scraping entry in Wikipedia]